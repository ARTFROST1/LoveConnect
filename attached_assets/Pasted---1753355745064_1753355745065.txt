–•–æ—á—É —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á—É—é, –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—é—é —Å–∏—Å—Ç–µ–º—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–≤ —á–µ—Ä–µ–∑ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –≤ Telegram WebApp-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ duoLove. –°–µ–π—á–∞—Å —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω—É–∂–Ω–æ. –ù–∏–∂–µ –æ–ø–∏—Å—ã–≤–∞—é —Ç–µ–∫—É—â—É—é –ø—Ä–æ–±–ª–µ–º—É –∏ —Ç–æ—á–Ω–æ–µ –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

‚ùå –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
–ò–≥—Ä–æ–∫ 1 –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, https://t.me/botname?start=invite_123456) ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç.

–ò–≥—Ä–æ–∫ 2 –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ, –±–æ—Ç –ø—Ä–∏—Å—ã–ª–∞–µ—Ç inline-–∫–Ω–æ–ø–∫—É ¬´–û—Ç–∫—Ä—ã—Ç—å duoLove¬ª ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç.

–ò–≥—Ä–æ–∫ 2 –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ‚Üí WebApp –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –Ω–æ:

‚ùå –ü–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–æ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è.

‚ùå –≠–∫—Ä–∞–Ω –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è ‚Äî –ø—Ä–æ—Å—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞ ‚Äú–î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä—Ç–Ω—ë—Ä–∞‚Äù.

‚ùå –£ –∏–≥—Ä–æ–∫–∞ 1 —Ç–∞–∫–∂–µ –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è ‚Äî –ø–∞—Ä—Ç–Ω—ë—Ä –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è.

‚úÖ –ö–∞–∫ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å (—Ü–µ–ª—å):
üì≤ –®–∞–≥–∏ –¥–ª—è –∏–≥—Ä–æ–∫–∞ 2 (–ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω–æ–≥–æ):
–ù–∞–∂–∏–º–∞–µ—Ç –Ω–∞ inline-–∫–Ω–æ–ø–∫—É ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è WebApp.

–í initDataUnsafe.start_param –ø—Ä–∏—Ö–æ–¥–∏—Ç invite_123456 (–≥–¥–µ 123456 ‚Äî Telegram ID –∏–≥—Ä–æ–∫–∞ 1).

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ —É–∂–µ –ø–∞—Ä—Ç–Ω—ë—Ä. –ï—Å–ª–∏ –Ω–µ—Ç:

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç partnerId = 123456

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É SQLite

–û–±–Ω–æ–≤–ª—è–µ—Ç UI: –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–∞—Ä—Ç–Ω—ë—Ä–æ–º

–ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—Ö–æ–¥–∞—Ö –ø–æ —Å—Å—ã–ª–∫–µ ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä —É–∂–µ –µ—Å—Ç—å.

üîÅ –£ –∏–≥—Ä–æ–∫–∞ 1 (–ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–≥–æ):
–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∏–≥—Ä–æ–∫ 2 –æ—Ç–∫—Ä—ã–ª WebApp –∏ –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è:

–£ –∏–≥—Ä–æ–∫–∞ 1 –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–≤—è–∑—å —Å –∏–≥—Ä–æ–∫–æ–º 2.

–î–ª—è —ç—Ç–æ–≥–æ:

–õ–∏–±–æ WebApp –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π polling (usePartnerSync) –∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–∞—Ä—Ç–Ω—ë—Ä–∞.

–õ–∏–±–æ Telegram-–±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏–≥–Ω–∞–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ hidden sendMessage) ‚Üí WebApp –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∏–≥—Ä–æ–∫–∞ 1 –∑–∞–ø—É—Å–∫–∞–µ—Ç refreshPartner().

üõ† –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏:
1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å start_param:
ts
Copy
Edit
useEffect(() => {
  const tg = window.Telegram?.WebApp;
  const startParam = tg?.initDataUnsafe?.start_param;

  if (startParam?.startsWith("invite_")) {
    const inviterTelegramId = startParam.replace("invite_", "");

    database.getPartner().then(current => {
      if (!current) {
        database.setPartner(inviterTelegramId).then(() => {
          refreshPartner();
        });
      }
    });
  }
}, []);
2. –ü—Ä–æ–≤–µ—Ä—è—Ç—å: –µ—Å–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚Üí –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —ç–∫—Ä–∞–Ω "–¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—Ç–Ω—ë—Ä–∞"
ts
Copy
Edit
if (!partner) {
  return <AddPartnerScreen />;
} else {
  return <MainScreenWithPartner />;
}
3. –£–±–µ–¥–∏—Å—å, —á—Ç–æ Telegram SDK —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –Ω–∞ –º–æ–º–µ–Ω—Ç —á—Ç–µ–Ω–∏—è start_param
–ù–µ–ª—å–∑—è –≤—ã–∑—ã–≤–∞—Ç—å SDK —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ ‚Äî –Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ Telegram –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è.

üß† UX –∏ –∑–∞—â–∏—Ç–∞:
–ï—Å–ª–∏ start_param –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∏–ª–∏ —É–∂–µ –µ—Å—Ç—å –ø–∞—Ä—Ç–Ω—ë—Ä ‚Äî –º–æ–ª—á–∞ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å.

–ù–∏–∫–∞–∫–∏—Ö –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö –æ—à–∏–±–æ–∫ "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ" ‚Äî –æ–Ω–∏ —Ç–æ–ª—å–∫–æ –º–µ—à–∞—é—Ç.

